<style>
  :root {
    --bg-color: #f4f7fc;
    --surface-color: #ffffff;
    --primary-color: #4f46e5;
    --primary-light: #e0e7ff;
    --primary-dark: #3730a3;
    --tertiary-color: #7c3aed;
    --text-primary: #1e293b;
    --text-secondary: #64748b;
    --border-color: #e2e8f0;
    --success-color: #10b981;
    --warning-color: #f59e0b;
    --danger-color: #ef4444;
    --font-sans: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
    --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
    --radius-md: 0.5rem;
    --radius-lg: 0.75rem;
  }
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { font-family: var(--font-sans); background-color: var(--bg-color); color: var(--text-primary); font-size: 14px; line-height: 1.5; }
  .container { max-width: 1280px; margin: 0 auto; padding: 2rem; }

  /* Header */
  .main-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 2rem; }
  .header-left { display: flex; align-items: center; gap: 1rem; }
  .logo-icon { color: var(--primary-color); width: 32px; height: 32px; }
  h1 { font-size: 1.5rem; font-weight: 700; }
  .header-info { display: flex; align-items: center; gap: 0.75rem; }
  .id-badge, .status-badge { padding: 0.25rem 0.75rem; border-radius: 99px; font-weight: 500; font-size: 0.875rem; }
  .id-badge { background-color: #eef2ff; color: var(--primary-dark); }
  .status-badge { color: #fff; }
  .status-リスク評価中 { background-color: var(--warning-color); }
  .status-改善報告中 { background-color: #3b82f6; }
  .status-差し戻し対応中 { background-color: var(--danger-color); } /* ★修正: 差し戻しステータスの色を追加 */
  .status-最終評価中, .status-再評価待ち { background-color: var(--primary-color); }
  .status-完了 { background-color: var(--success-color); }

  /* Main Layout */
  .main-content { display: grid; grid-template-columns: 2fr 1fr; gap: 2rem; align-items: start; }
  @media(max-width: 1024px) { .main-content { grid-template-columns: 1fr; } }
  .sidebar { position: sticky; top: 2rem; }
  
  /* Timeline */
  .timeline { display: flex; flex-direction: column; gap: 1.5rem; }
  .timeline-item { display: flex; gap: 1rem; }
  .timeline-icon { flex-shrink: 0; width: 40px; height: 40px; border-radius: 50%; background-color: var(--primary-light); color: var(--primary-color); display: flex; align-items: center; justify-content: center; }
  .timeline-item .card { width: 100%; }

  /* Card */
  .card { background-color: var(--surface-color); border: 1px solid var(--border-color); border-radius: var(--radius-lg); box-shadow: var(--shadow-sm); }
  .card.is-active { border-color: var(--primary-color); box-shadow: var(--shadow-md); }
  .card-header { padding: 1rem 1.5rem; border-bottom: 1px solid var(--border-color); display: flex; justify-content: space-between; align-items: center; }
  .card-title { font-size: 1.125rem; font-weight: 600; }
  .timestamp { font-size: 0.875rem; color: var(--text-secondary); }
  .card-body { padding: 1.5rem; }

  /* Forms & Info */
  .info-grid { display: grid; grid-template-columns: 120px 1fr; gap: 0.75rem 1rem; align-items: baseline; }
  .info-label { color: var(--text-secondary); font-weight: 500; }
  .pre-wrap { white-space: pre-wrap; }
  .form-group { margin-bottom: 1.25rem; }
  .form-group:last-child { margin-bottom: 0; }
  .form-group-inline { flex: 1 1 0; }
  .form-label { display: block; font-weight: 500; margin-bottom: 0.5rem; font-size: 0.875rem; }
  .form-input { width: 100%; padding: 0.625rem 1rem; border: 1px solid var(--border-color); border-radius: var(--radius-md); font-size: 1rem; transition: all 0.2s; }
  .form-input:focus { outline: none; border-color: var(--primary-color); box-shadow: 0 0 0 3px var(--primary-light); }
  .form-grid-3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; }
  .form-grid-4 { display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem; }
  @media(max-width: 768px) { .form-grid-3, .form-grid-4 { grid-template-columns: repeat(2, 1fr); } }
  @media(max-width: 640px) { .form-grid-3, .form-grid-4 { grid-template-columns: 1fr; } }

  .form-grid-3, .form-grid-4 { grid-template-columns: 1fr; } }

/* ★追加: fieldset スタイル */
.form-fieldset {
  border: 1px solid var(--border-color);
  border-radius: var(--radius-md);
  padding: 1.5rem;
  margin-bottom: 1.25rem;
}
.form-legend {
  padding: 0 0.5rem;
  font-weight: 600;
  font-size: 1rem;
}

/* Buttons */
.btn { display: inline-flex; align-items: center; justify-content: center; gap: 0.5rem; padding: 0.625rem 1.25rem; border: 1px solid transparent; border-radius: var(--radius-md); font-size: 0.875rem; font-weight: 600; cursor: pointer; transition: all 0.2s; text-decoration: none; }

  .btn-primary { background-color: var(--primary-color); color: #fff; }
  .btn-primary:hover { background-color: var(--primary-dark); }
  .btn-secondary { background-color: var(--surface-color); color: var(--text-primary); border-color: var(--border-color); }
  .btn-secondary:hover { background-color: #f9fafb; }
  .btn-tertiary { background-color: var(--primary-light); color: var(--primary-color); }
  .btn-tertiary:hover { background-color: #c7d2fe; }
  .btn-danger { background-color: var(--danger-color); color: #fff; }
  .btn:disabled { opacity: 0.5; cursor: not-allowed; }
  .btn-group { display: flex; justify-content: flex-end; gap: 0.75rem; margin-top: 1rem; }
  .btn-icon { background: none; border: none; cursor: pointer; color: var(--text-secondary); }

  /* Specific Components */
  .ai-evaluation { background-color: #f9fafb; border: 1px dashed var(--border-color); padding: 1.5rem; border-radius: var(--radius-md); margin-bottom: 1.5rem; }
  .ai-evaluation h3 { font-size: 1rem; font-weight: 600; margin-bottom: 1rem; }
  .score-correction { margin-top: 1.5rem; }
  .score-correction-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem; }
  .score-correction-title { font-size: 1rem; font-weight: 600; margin: 0; }
  .badge-modified { background-color: var(--tertiary-color); color: #fff; padding: 0.2rem 0.6rem; font-size: 0.75rem; border-radius: 99px; }
  .score-form { display: flex; gap: 1rem; align-items: flex-end; }
  .final-eval-section { margin-bottom: 1.5rem; padding-bottom: 1.5rem; border-bottom: 1px solid var(--border-color); }
  .final-eval-section:last-child { border-bottom: none; margin-bottom: 0; padding-bottom: 0;}
  .score-table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
  .score-table th, .score-table td { padding: 0.75rem; text-align: center; border-bottom: 1px solid var(--border-color); }
  .score-table th { font-size: 0.75rem; font-weight: 600; color: var(--text-secondary); background-color: #f9fafb; }
  .score-table tr:last-child td { border-bottom: none; }
  .score-value { font-weight: 700; }
  .reduction-value { color: var(--success-color); }
  .priority-badge { display: inline-block; padding: 2px 8px; border-radius: 99px; font-size: 12px; font-weight: 600; }
  .priority-高 { background-color: #fee2e2; color: #b91c1c; }
  .priority-中 { background-color: #ffedd5; color: #9a3412; }
  .priority-低 { background-color: #d1fae5; color: #065f46; }
  .revert-history-list { display: flex; flex-direction: column; gap: 1rem; }
  .revert-item { font-size: 0.875rem; }
  .revert-meta { color: var(--text-secondary); font-size: 0.75rem; }
  .revert-reason { margin-top: 0.25rem; }
  /* ★追加: 差し戻し情報表示用のスタイル */
  .revert-info-box { background-color: #fff5f5; border: 1px solid var(--danger-color); color: #c81e1e; padding: 1.5rem; border-radius: var(--radius-md); margin-bottom: 1.5rem; }
  .revert-info-header { font-weight: 600; font-size: 1rem; margin-bottom: 1rem; }
  .internal-card { background-color: #f9fafb; border: 1px solid var(--border-color); border-radius: var(--radius-md); padding: 1rem; }
  .toggle-container-vertical { display: flex; flex-direction: column; align-items: flex-start; gap: 0.5rem; }
  .input-with-button { display: flex; gap: 0.5rem; }
  .input-with-button .form-input { flex-grow: 1; }
  .input-with-button .btn { flex-shrink: 0; }
  .ojt-final-check { display: flex; align-items: center; justify-content: space-between; gap: 1rem; }

  /* OJT Toggle */
  .toggle { position: relative; display: inline-block; width: 44px; height: 24px; }
  .toggle input { opacity: 0; width: 0; height: 0; }
  .toggle-slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 24px; }
  .toggle-slider:before { position: absolute; content: ""; height: 20px; width: 20px; left: 2px; bottom: 2px; background-color: white; transition: .4s; border-radius: 50%; }
  input:checked + .toggle-slider { background-color: var(--primary-color); }
  input:checked + .toggle-slider:before { transform: translateX(20px); }
  
  /* Modal */
  .modal { display: none; position: fixed; inset: 0; background-color: rgba(0,0,0,0.5); backdrop-filter: blur(4px); z-index: 50; align-items: center; justify-content: center; }
  .modal-content { background-color: var(--surface-color); border-radius: var(--radius-lg); width: 90%; max-width: 500px; box-shadow: var(--shadow-md); }
  .modal-header { padding: 1rem 1.5rem; border-bottom: 1px solid var(--border-color); display: flex; justify-content: space-between; align-items: center; }
  .modal-content form { padding: 1.5rem; }

  /* Utility */
  .inline-msg { margin-top: 1rem; text-align: right; min-height: 1.25rem; font-size: 0.875rem; }
  .inline-msg.success { color: var(--success-color); }
  .inline-msg.error { color: var(--danger-color); }
  .inline-msg.info { color: var(--text-secondary); }
</style>